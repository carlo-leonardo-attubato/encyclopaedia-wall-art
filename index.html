<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1960s Encyclopaedia Wall Art Gallery</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Georgia', serif;
            background: #1a1a1a;
            color: #e8e8e8;
            line-height: 1.6;
        }
        
        header {
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            padding: 40px 20px;
            text-align: center;
            border-bottom: 1px solid #333;
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: 300;
            letter-spacing: 2px;
            margin-bottom: 10px;
            color: #f0f0f0;
        }
        
        header p {
            color: #888;
            font-size: 1.1rem;
        }
        
        .controls {
            background: #222;
            padding: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
            border-bottom: 1px solid #333;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .controls label {
            color: #aaa;
            font-size: 0.9rem;
        }
        
        .controls select, .controls input {
            background: #333;
            border: 1px solid #444;
            color: #fff;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .controls select:focus, .controls input:focus {
            outline: none;
            border-color: #666;
        }
        
        .filter-btn {
            background: #333;
            border: 1px solid #444;
            color: #ccc;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background: #4a7c59;
            border-color: #4a7c59;
            color: #fff;
        }
        
        .stats {
            text-align: center;
            padding: 15px;
            background: #1f1f1f;
            color: #888;
            font-size: 0.9rem;
        }
        
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            padding: 30px;
            max-width: 1800px;
            margin: 0 auto;
        }
        
        .card {
            background: #252525;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        }
        
        .card.recommended {
            border: 2px solid #4a7c59;
        }
        
        .card.top-pick {
            border: 2px solid #d4af37;
        }
        
        .card-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }
        
        .card-content {
            padding: 15px;
        }
        
        .card-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: #f0f0f0;
        }
        
        .card-file {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 8px;
        }
        
        .card-verdict {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .verdict-yes { background: #4a7c59; color: #fff; }
        .verdict-decent { background: #5a5a2a; color: #fff; }
        .verdict-weak { background: #6a4a3a; color: #fff; }
        .verdict-no { background: #4a3a3a; color: #aaa; }
        
        .card-batch {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            color: #fff;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
        }
        
        .card-rank {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #d4af37;
            color: #000;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            display: flex;
            flex-direction: row;
            max-width: 1400px;
            margin: auto;
            padding: 20px;
            gap: 30px;
            width: 100%;
        }
        
        @media (max-width: 900px) {
            .modal-content {
                flex-direction: column;
            }
        }
        
        .modal-image-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-image {
            max-width: 100%;
            max-height: 80vh;
            object-fit: contain;
            border-radius: 4px;
        }
        
        .modal-info {
            flex: 0 0 350px;
            background: #252525;
            border-radius: 8px;
            padding: 30px;
        }
        
        .modal-title {
            font-size: 1.8rem;
            font-weight: 300;
            margin-bottom: 5px;
            color: #f0f0f0;
        }
        
        .modal-file {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        .modal-section {
            margin-bottom: 20px;
        }
        
        .modal-section h3 {
            color: #888;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        
        .modal-section p {
            color: #ccc;
            font-size: 1rem;
        }
        
        .modal-verdict {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .modal-rank-badge {
            background: linear-gradient(135deg, #d4af37 0%, #b8960c 100%);
            color: #000;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            margin-top: 10px;
            display: inline-block;
        }
        
        .close-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #333;
            border: none;
            color: #fff;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 1001;
            transition: background 0.2s;
        }
        
        .close-btn:hover {
            background: #555;
        }
        
        .nav-btn {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            background: #333;
            border: none;
            color: #fff;
            width: 50px;
            height: 80px;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 1001;
            transition: background 0.2s;
        }
        
        .nav-btn:hover {
            background: #555;
        }
        
        .nav-prev { left: 10px; border-radius: 0 8px 8px 0; }
        .nav-next { right: 10px; border-radius: 8px 0 0 8px; }
        
        /* Top picks section */
        .top-picks-section {
            background: #1f1f1f;
            padding: 40px 30px;
            border-bottom: 1px solid #333;
        }
        
        .top-picks-section h2 {
            text-align: center;
            font-weight: 300;
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: #d4af37;
        }
        
        .tier {
            margin-bottom: 30px;
        }
        
        .tier h3 {
            color: #888;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 3px solid #4a7c59;
        }
        
        .tier-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .tier-item {
            background: #2a2a2a;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .tier-item:hover {
            background: #4a7c59;
        }
        
        .tier-item .rank {
            color: #d4af37;
            font-weight: bold;
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <header>
        <h1>1960s Encyclopaedia Wall Art</h1>
        <p>109 vintage encyclopaedia pages reviewed for wall art potential</p>
        <p style="color: #666; font-size: 0.9rem; margin-top: 8px;">Descriptions and rankings by Claude Opus 4.5</p>
    </header>
    
    <div class="controls">
        <div>
            <label>Filter: </label>
            <button class="filter-btn active" data-filter="all">All</button>
            <button class="filter-btn" data-filter="yes">Recommended</button>
            <button class="filter-btn" data-filter="decent">Decent</button>
            <button class="filter-btn" data-filter="no">Not Recommended</button>
        </div>
        <div>
            <label>Batch: </label>
            <select id="batchFilter">
                <option value="all">All Batches</option>
                <option value="1">Batch 1</option>
                <option value="2">Batch 2</option>
                <option value="3">Batch 3</option>
                <option value="4">Batch 4</option>
                <option value="5">Batch 5</option>
                <option value="6">Batch 6</option>
            </select>
        </div>
        <div>
            <label>Sort: </label>
            <select id="sortOrder">
                <option value="rank">By Rank</option>
                <option value="file">By File Number</option>
                <option value="batch">By Batch</option>
            </select>
        </div>
        <div>
            <input type="text" id="searchBox" placeholder="Search subjects...">
        </div>
    </div>
    
    <div class="stats" id="stats">Showing 100 images</div>
    
    <section class="top-picks-section">
        <h2>★ Top 20 Picks ★</h2>
        <div class="tier">
            <h3>Tier 1: Outstanding</h3>
            <div class="tier-items" id="tier1"></div>
        </div>
        <div class="tier">
            <h3>Tier 2: Excellent</h3>
            <div class="tier-items" id="tier2"></div>
        </div>
        <div class="tier">
            <h3>Tier 3: Very Good</h3>
            <div class="tier-items" id="tier3"></div>
        </div>
        <div class="tier">
            <h3>Tier 4: Good</h3>
            <div class="tier-items" id="tier4"></div>
        </div>
    </section>
    
    <div class="gallery" id="gallery"></div>
    
    <div class="modal" id="modal">
        <button class="close-btn" onclick="closeModal()">×</button>
        <button class="nav-btn nav-prev" onclick="navigate(-1)">‹</button>
        <button class="nav-btn nav-next" onclick="navigate(1)">›</button>
        <div class="modal-content">
            <div class="modal-image-container">
                <img class="modal-image" id="modalImage" src="" alt="">
            </div>
            <div class="modal-info">
                <h2 class="modal-title" id="modalTitle"></h2>
                <p class="modal-file" id="modalFile"></p>
                
                <div class="modal-section">
                    <h3>Wall Art Verdict</h3>
                    <span class="modal-verdict" id="modalVerdict"></span>
                </div>
                
                <div class="modal-section">
                    <h3>Description</h3>
                    <p id="modalDescription"></p>
                </div>
                
                <div class="modal-section">
                    <h3>Notes</h3>
                    <p id="modalNotes"></p>
                </div>
                
                <div class="modal-section">
                    <h3>Batch</h3>
                    <p id="modalBatch"></p>
                </div>

                <div class="modal-section" id="modalPageTextSection">
                    <h3>Original Page Text</h3>
                    <p id="modalPageText" style="font-size: 0.85rem; line-height: 1.5; white-space: pre-wrap;"></p>
                </div>

                <div class="modal-section" id="modalRankSection" style="display:none;">
                    <h3>Overall Ranking</h3>
                    <div class="modal-rank-badge" id="modalRank"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
let imageData = [];

let currentFilter = 'all';
let currentBatch = 'all';
let currentSort = 'rank';
let searchTerm = '';
let currentModalIndex = -1;
let filteredData = [];

function getVerdictClass(verdict) {
    if (verdict === 'yes') return 'verdict-yes';
    if (verdict === 'decent') return 'verdict-decent';
    if (verdict === 'weak') return 'verdict-weak';
    return 'verdict-no';
}

function getVerdictLabel(verdict) {
    if (verdict === 'yes') return 'Recommended';
    if (verdict === 'decent') return 'Decent';
    if (verdict === 'weak') return 'Weak';
    return 'Not Recommended';
}

function filterAndSort() {
    filteredData = imageData.filter(item => {
        // Filter by verdict
        if (currentFilter !== 'all') {
            if (currentFilter === 'yes' && item.verdict !== 'yes') return false;
            if (currentFilter === 'decent' && item.verdict !== 'decent') return false;
            if (currentFilter === 'no' && (item.verdict !== 'no' && item.verdict !== 'weak')) return false;
        }
        
        // Filter by batch
        if (currentBatch !== 'all' && item.batch !== parseInt(currentBatch)) return false;
        
        // Filter by search
        if (searchTerm) {
            const search = searchTerm.toLowerCase();
            const searchFields = [
                item.subject,
                item.description,
                item.notes,
                item.pageText,
                item.file
            ].filter(Boolean).map(s => s.toLowerCase());
            if (!searchFields.some(field => field.includes(search))) return false;
        }
        
        return true;
    });
    
    // Sort
    if (currentSort === 'rank') {
        filteredData.sort((a, b) => {
            if (a.rank && b.rank) return a.rank - b.rank;
            if (a.rank) return -1;
            if (b.rank) return 1;
            return parseInt(a.file) - parseInt(b.file);
        });
    } else if (currentSort === 'file') {
        filteredData.sort((a, b) => parseInt(a.file) - parseInt(b.file));
    } else if (currentSort === 'batch') {
        filteredData.sort((a, b) => {
            if (a.batch !== b.batch) return a.batch - b.batch;
            return parseInt(a.file) - parseInt(b.file);
        });
    }
    
    renderGallery();
    updateStats();
}

function renderGallery() {
    const gallery = document.getElementById('gallery');
    gallery.innerHTML = filteredData.map((item, index) => `
        <div class="card ${item.verdict === 'yes' ? 'recommended' : ''} ${item.rank ? 'top-pick' : ''}" 
             onclick="openModal(${index})">
            <span class="card-batch">Batch ${item.batch}</span>
            ${item.rank ? `<span class="card-rank">#${item.rank}</span>` : ''}
            <img class="card-image" src="images/IMG_${item.file}.jpg" alt="${item.subject}" loading="lazy">
            <div class="card-content">
                <h3 class="card-title">${item.subject}</h3>
                <p class="card-file">IMG_${item.file}</p>
                <span class="card-verdict ${getVerdictClass(item.verdict)}">${getVerdictLabel(item.verdict)}</span>
            </div>
        </div>
    `).join('');
}

function updateStats() {
    const stats = document.getElementById('stats');
    const recommended = filteredData.filter(i => i.verdict === 'yes').length;
    stats.textContent = `Showing ${filteredData.length} images (${recommended} recommended)`;
}

function openModal(index) {
    currentModalIndex = index;
    const item = filteredData[index];
    
    document.getElementById('modalImage').src = `images/IMG_${item.file}.jpg`;
    document.getElementById('modalTitle').textContent = item.subject;
    document.getElementById('modalFile').textContent = `IMG_${item.file}.jpg`;
    document.getElementById('modalDescription').textContent = item.description;
    document.getElementById('modalNotes').textContent = item.notes;
    document.getElementById('modalBatch').textContent = `Batch ${item.batch}`;
    
    const verdictEl = document.getElementById('modalVerdict');
    verdictEl.textContent = getVerdictLabel(item.verdict);
    verdictEl.className = `modal-verdict ${getVerdictClass(item.verdict)}`;
    
    const rankSection = document.getElementById('modalRankSection');
    if (item.rank) {
        rankSection.style.display = 'block';
        document.getElementById('modalRank').textContent = `#${item.rank} of 100`;
    } else {
        rankSection.style.display = 'none';
    }

    const pageTextSection = document.getElementById('modalPageTextSection');
    if (item.pageText) {
        pageTextSection.style.display = 'block';
        document.getElementById('modalPageText').textContent = item.pageText;
    } else {
        pageTextSection.style.display = 'none';
    }

    document.getElementById('modal').classList.add('active');
    document.body.style.overflow = 'hidden';
}

function closeModal() {
    document.getElementById('modal').classList.remove('active');
    document.body.style.overflow = '';
}

function navigate(direction) {
    currentModalIndex += direction;
    if (currentModalIndex < 0) currentModalIndex = filteredData.length - 1;
    if (currentModalIndex >= filteredData.length) currentModalIndex = 0;
    openModal(currentModalIndex);
}

function scrollToImage(file) {
    closeModal();
    currentFilter = 'all';
    currentBatch = 'all';
    searchTerm = '';
    document.getElementById('batchFilter').value = 'all';
    document.getElementById('searchBox').value = '';
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('[data-filter="all"]').classList.add('active');
    
    filterAndSort();
    
    const index = filteredData.findIndex(i => i.file === file);
    if (index >= 0) {
        openModal(index);
    }
}

function renderTopPicks() {
    const tiers = [
        { id: 'tier1', items: imageData.filter(i => i.rank && i.rank <= 5) },
        { id: 'tier2', items: imageData.filter(i => i.rank && i.rank > 5 && i.rank <= 10) },
        { id: 'tier3', items: imageData.filter(i => i.rank && i.rank > 10 && i.rank <= 15) },
        { id: 'tier4', items: imageData.filter(i => i.rank && i.rank > 15 && i.rank <= 20) }
    ];
    
    tiers.forEach(tier => {
        const container = document.getElementById(tier.id);
        tier.items.sort((a, b) => a.rank - b.rank);
        container.innerHTML = tier.items.map(item => `
            <div class="tier-item" onclick="scrollToImage('${item.file}')">
                <span class="rank">#${item.rank}</span> ${item.subject}
            </div>
        `).join('');
    });
}

// Event listeners
document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentFilter = btn.dataset.filter;
        filterAndSort();
    });
});

document.getElementById('batchFilter').addEventListener('change', (e) => {
    currentBatch = e.target.value;
    filterAndSort();
});

document.getElementById('sortOrder').addEventListener('change', (e) => {
    currentSort = e.target.value;
    filterAndSort();
});

document.getElementById('searchBox').addEventListener('input', (e) => {
    searchTerm = e.target.value;
    filterAndSort();
});

document.addEventListener('keydown', (e) => {
    if (document.getElementById('modal').classList.contains('active')) {
        if (e.key === 'Escape') closeModal();
        if (e.key === 'ArrowLeft') navigate(-1);
        if (e.key === 'ArrowRight') navigate(1);
    }
});

document.getElementById('modal').addEventListener('click', (e) => {
    if (e.target.id === 'modal') closeModal();
});

// Initialize - load data from JSON
fetch('data.json')
    .then(response => response.json())
    .then(data => {
        imageData = data;
        renderTopPicks();
        filterAndSort();
    })
    .catch(error => {
        console.error('Error loading data:', error);
        document.getElementById('gallery').innerHTML = '<p style="color: red; padding: 20px;">Error loading image data. Please refresh the page.</p>';
    });
    </script>
</body>
</html>
